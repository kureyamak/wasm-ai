!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(self,(()=>(()=>{"use strict";var t={986:(t,e,r)=>{r.d(e,{debug:()=>n});const n=new class{enable(t){this.log=function(t,e){return t?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}(void 0===t||t,this.prefix)}get enabled(){return this.isEnabled}constructor(t){this.isEnabled=t,this.prefix="wasi:",this.enable(t)}}(!1)},851:(t,e,r)=>{r.d(e,{Fd:()=>s});var n=r(228);class s{fd_advise(t,e,r){return n.ERRNO_NOTSUP}fd_allocate(t,e){return n.ERRNO_NOTSUP}fd_close(){return 0}fd_datasync(){return n.ERRNO_NOTSUP}fd_fdstat_get(){return{ret:n.ERRNO_NOTSUP,fdstat:null}}fd_fdstat_set_flags(t){return n.ERRNO_NOTSUP}fd_fdstat_set_rights(t,e){return n.ERRNO_NOTSUP}fd_filestat_get(){return{ret:n.ERRNO_NOTSUP,filestat:null}}fd_filestat_set_size(t){return n.ERRNO_NOTSUP}fd_filestat_set_times(t,e,r){return n.ERRNO_NOTSUP}fd_pread(t,e,r){return{ret:n.ERRNO_NOTSUP,nread:0}}fd_prestat_get(){return{ret:n.ERRNO_NOTSUP,prestat:null}}fd_prestat_dir_name(){return{ret:n.ERRNO_NOTSUP,prestat_dir_name:null}}fd_pwrite(t,e,r){return{ret:n.ERRNO_NOTSUP,nwritten:0}}fd_read(t,e){return{ret:n.ERRNO_NOTSUP,nread:0}}fd_readdir_single(t){return{ret:n.ERRNO_NOTSUP,dirent:null}}fd_seek(t,e){return{ret:n.ERRNO_NOTSUP,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:n.ERRNO_NOTSUP,offset:0n}}fd_write(t,e){return{ret:n.ERRNO_NOTSUP,nwritten:0}}path_create_directory(t){return n.ERRNO_NOTSUP}path_filestat_get(t,e){return{ret:n.ERRNO_NOTSUP,filestat:null}}path_filestat_set_times(t,e,r,s,i){return n.ERRNO_NOTSUP}path_link(t,e,r,s){return n.ERRNO_NOTSUP}path_open(t,e,r,s,i,_){return{ret:n.ERRNO_NOTSUP,fd_obj:null}}path_readlink(t){return{ret:n.ERRNO_NOTSUP,data:null}}path_remove_directory(t){return n.ERRNO_NOTSUP}path_rename(t,e,r){return n.ERRNO_NOTSUP}path_symlink(t,e){return n.ERRNO_NOTSUP}path_unlink_file(t){return n.ERRNO_NOTSUP}}},862:(t,e,r)=>{r.d(e,{ConsoleStdout:()=>E,Directory:()=>d,File:()=>a,OpenDirectory:()=>o,OpenFile:()=>_,OpenSyncOPFSFile:()=>f,PreopenDirectory:()=>R,SyncOPFSFile:()=>l});var n=r(986),s=r(228),i=r(851);class _ extends i.Fd{fd_fdstat_get(){return{ret:0,fdstat:new s.Fdstat(s.FILETYPE_REGULAR_FILE,0)}}fd_read(t,e){let r=0;for(const n of e){if(!(this.file_pos<this.file.data.byteLength))break;{const e=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(n.buf_len)));t.set(e,n.buf),this.file_pos+=BigInt(e.length),r+=e.length}}return{ret:0,nread:r}}fd_pread(t,e,r){let n=0;for(const s of e){if(!(r<this.file.data.byteLength))break;{const e=this.file.data.slice(Number(r),Number(r+BigInt(s.buf_len)));t.set(e,s.buf),r+=BigInt(e.length),n+=e.length}}return{ret:0,nread:n}}fd_seek(t,e){let r;switch(e){case s.WHENCE_SET:r=t;break;case s.WHENCE_CUR:r=this.file_pos+t;break;case s.WHENCE_END:r=BigInt(this.file.data.byteLength)+t;break;default:return{ret:s.ERRNO_INVAL,offset:0n}}return r<0?{ret:s.ERRNO_INVAL,offset:0n}:(this.file_pos=r,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(t,e){let r=0;if(this.file.readonly)return{ret:s.ERRNO_BADF,nwritten:r};for(const n of e){const e=t.slice(n.buf,n.buf+n.buf_len);if(this.file_pos+BigInt(e.byteLength)>this.file.size){const t=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(t)}this.file.data.set(e.slice(0,Number(this.file.size-this.file_pos)),Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),r+=n.buf_len}return{ret:0,nwritten:r}}fd_pwrite(t,e,r){let n=0;if(this.file.readonly)return{ret:s.ERRNO_BADF,nwritten:n};for(const s of e){const e=t.slice(s.buf,s.buf+s.buf_len);if(r+BigInt(e.byteLength)>this.file.size){const t=this.file.data;this.file.data=new Uint8Array(Number(r+BigInt(e.byteLength))),this.file.data.set(t)}this.file.data.set(e.slice(0,Number(this.file.size-r)),Number(r)),r+=BigInt(e.byteLength),n+=s.buf_len}return{ret:0,nwritten:n}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(t){super(),this.file_pos=0n,this.file=t}}class f extends i.Fd{fd_fdstat_get(){return{ret:0,fdstat:new s.Fdstat(s.FILETYPE_REGULAR_FILE,0)}}fd_filestat_get(){return{ret:0,filestat:new s.Filestat(s.FILETYPE_REGULAR_FILE,BigInt(this.file.handle.getSize()))}}fd_read(t,e){let r=0;for(const n of e){if(!(this.position<this.file.handle.getSize()))break;{const e=new Uint8Array(t.buffer,n.buf,n.buf_len),s=this.file.handle.read(e,{at:Number(this.position)});this.position+=BigInt(s),r+=s}}return{ret:0,nread:r}}fd_seek(t,e){let r;switch(e){case s.WHENCE_SET:r=BigInt(t);break;case s.WHENCE_CUR:r=this.position+BigInt(t);break;case s.WHENCE_END:r=BigInt(this.file.handle.getSize())+BigInt(t);break;default:return{ret:s.ERRNO_INVAL,offset:0n}}return r<0?{ret:s.ERRNO_INVAL,offset:0n}:(this.position=r,{ret:s.ERRNO_SUCCESS,offset:this.position})}fd_write(t,e){let r=0;if(this.file.readonly)return{ret:s.ERRNO_BADF,nwritten:r};for(const n of e){const e=new Uint8Array(t.buffer,n.buf,n.buf_len),s=this.file.handle.write(e,{at:Number(this.position)});this.position+=BigInt(s),r+=s}return{ret:s.ERRNO_SUCCESS,nwritten:r}}fd_datasync(){return this.file.handle.flush(),s.ERRNO_SUCCESS}fd_sync(){return this.fd_datasync()}fd_close(){return s.ERRNO_SUCCESS}constructor(t){super(),this.position=0n,this.file=t}}class o extends i.Fd{fd_fdstat_get(){return{ret:0,fdstat:new s.Fdstat(s.FILETYPE_DIRECTORY,0)}}fd_readdir_single(t){if(n.debug.enabled&&(n.debug.log("readdir_single",t),n.debug.log(t,Object.keys(this.dir.contents))),n.debug.log(t,Object.keys(this.dir.contents).slice(Number(t))),t>=BigInt(Object.keys(this.dir.contents).length))return{ret:0,dirent:null};const e=Object.keys(this.dir.contents)[Number(t)],r=this.dir.contents[e];return{ret:0,dirent:new s.Dirent(t+1n,e,r.stat().filetype)}}path_filestat_get(t,e){const r=this.dir.get_entry_for_path(e);return null==r?{ret:s.ERRNO_NOENT,filestat:null}:{ret:0,filestat:r.stat()}}path_open(t,e,r,n,i,_){let f=this.dir.get_entry_for_path(e);if(null==f){if((r&s.OFLAGS_CREAT)!=s.OFLAGS_CREAT)return{ret:s.ERRNO_NOENT,fd_obj:null};f=this.dir.create_entry_for_path(e,(r&s.OFLAGS_DIRECTORY)==s.OFLAGS_DIRECTORY)}else if((r&s.OFLAGS_EXCL)==s.OFLAGS_EXCL)return{ret:s.ERRNO_EXIST,fd_obj:null};if((r&s.OFLAGS_DIRECTORY)==s.OFLAGS_DIRECTORY&&f.stat().filetype!==s.FILETYPE_DIRECTORY)return{ret:s.ERRNO_NOTDIR,fd_obj:null};if(f.readonly&&(n&BigInt(s.RIGHTS_FD_WRITE))==BigInt(s.RIGHTS_FD_WRITE))return{ret:s.ERRNO_PERM,fd_obj:null};if(!(f instanceof d)&&(r&s.OFLAGS_TRUNC)==s.OFLAGS_TRUNC){const t=f.truncate();if(t!=s.ERRNO_SUCCESS)return{ret:t,fd_obj:null}}return{ret:s.ERRNO_SUCCESS,fd_obj:f.open(_)}}path_create_directory(t){return this.path_open(0,t,s.OFLAGS_CREAT|s.OFLAGS_DIRECTORY,0n,0n,0).ret}path_unlink_file(t){t=this.clean_path(t);const e=this.dir.get_parent_dir_for_path(t),r=t.split("/"),n=r[r.length-1],i=this.dir.get_entry_for_path(t);return null===i?s.ERRNO_NOENT:i.stat().filetype===s.FILETYPE_DIRECTORY?s.ERRNO_ISDIR:(delete e.contents[n],s.ERRNO_SUCCESS)}path_remove_directory(t){t=this.clean_path(t);const e=this.dir.get_parent_dir_for_path(t),r=t.split("/"),n=r[r.length-1],i=this.dir.get_entry_for_path(t);return null===i?s.ERRNO_NOENT:i instanceof d&&i.stat().filetype===s.FILETYPE_DIRECTORY?0!==Object.keys(i.contents).length?s.ERRNO_NOTEMPTY:void 0===e.contents[n]?s.ERRNO_NOENT:(delete e.contents[n],s.ERRNO_SUCCESS):s.ERRNO_NOTDIR}clean_path(t){for(;t.length>0&&"/"===t[t.length-1];)t=t.slice(0,t.length-1);return t}constructor(t){super(),this.dir=t}}class R extends o{fd_prestat_get(){return{ret:0,prestat:s.Prestat.dir(this.prestat_name.length)}}fd_prestat_dir_name(){return{ret:0,prestat_dir_name:this.prestat_name}}constructor(t,e){super(new d(e)),this.prestat_name=(new TextEncoder).encode(t)}}class a{open(t){const e=new _(this);return t&s.FDFLAGS_APPEND&&e.fd_seek(0n,s.WHENCE_END),e}get size(){return BigInt(this.data.byteLength)}stat(){return new s.Filestat(s.FILETYPE_REGULAR_FILE,this.size)}truncate(){return this.readonly?s.ERRNO_PERM:(this.data=new Uint8Array([]),s.ERRNO_SUCCESS)}constructor(t,e){this.data=new Uint8Array(t),this.readonly=!!e?.readonly}}class l{open(t){const e=new f(this);return t&s.FDFLAGS_APPEND&&e.fd_seek(0n,s.WHENCE_END),e}get size(){return BigInt(this.handle.getSize())}stat(){return new s.Filestat(s.FILETYPE_REGULAR_FILE,this.size)}truncate(){return this.readonly?s.ERRNO_PERM:(this.handle.truncate(0),s.ERRNO_SUCCESS)}constructor(t,e){this.handle=t,this.readonly=!!e?.readonly}}class d{open(t){return new o(this)}stat(){return new s.Filestat(s.FILETYPE_DIRECTORY,0n)}get_entry_for_path(t){let e=this;for(const r of t.split("/")){if(""==r)break;if("."!=r){if(!(e instanceof d))return null;if(null==e.contents[r])return n.debug.log(r),null;e=e.contents[r]}}return e}get_parent_dir_for_path(t){if(""===t)return null;let e=this,r=e;for(const s of t.split("/")){if(""===s)break;if("."!==s){if(!(e instanceof d))return n.debug.log(e),null;if(void 0===e.contents[s])return n.debug.log(s),null;r=e,e=e.contents[s]}}return r}create_entry_for_path(t,e){let r=this;const s=t.split("/").filter((t=>"/"!=t));for(let t=0;t<s.length;t++){const i=s[t];if(!(r instanceof d))break;null!=r.contents[i]||(n.debug.log("create",i),t!=s.length-1||e?r.contents[i]=new d({}):r.contents[i]=new a(new ArrayBuffer(0))),r=r.contents[i]}return r}constructor(t){this.readonly=!1,this.contents=t}}class E extends i.Fd{fd_filestat_get(){return{ret:0,filestat:new s.Filestat(s.FILETYPE_CHARACTER_DEVICE,BigInt(0))}}fd_fdstat_get(){const t=new s.Fdstat(s.FILETYPE_CHARACTER_DEVICE,0);return t.fs_rights_base=BigInt(s.RIGHTS_FD_WRITE),{ret:0,fdstat:t}}fd_write(t,e){let r=0;for(const n of e){const e=t.slice(n.buf,n.buf+n.buf_len);this.write(e),r+=n.buf_len}return{ret:0,nwritten:r}}static lineBuffered(t){const e=new TextDecoder("utf-8",{fatal:!1});let r="";return new E((n=>{r+=e.decode(n,{stream:!0});const s=r.split("\n");for(const[e,n]of s.entries())e<s.length-1?t(n):r=n}))}constructor(t){super(),this.write=t}}},171:(t,e,r)=>{function n(t,e){return new Proxy(t,{get(t,r,n){const s=Reflect.get(t,r,n);return e.includes(r)?s:function(...t){console.log(r,"(",...t,")");const e=Reflect.apply(s,n,t);return console.log(" =",e),e}}})}r.d(e,{strace:()=>n})},93:(t,e,r)=>{r.d(e,{default:()=>_});var n=r(228),s=r(986);class i extends Error{constructor(t){super("exit with exit code "+t),this.code=t}}let _=class{start(t){this.inst=t;try{return t.exports._start(),0}catch(t){if(t instanceof i)return t.code;throw t}}initialize(t){this.inst=t,t.exports._initialize()}constructor(t,e,r,_={}){this.args=[],this.env=[],this.fds=[],s.debug.enable(_.debug),this.args=t,this.env=e,this.fds=r;const f=this;this.wasiImport={args_sizes_get(t,e){const r=new DataView(f.inst.exports.memory.buffer);r.setUint32(t,f.args.length,!0);let n=0;for(const t of f.args)n+=t.length+1;return r.setUint32(e,n,!0),s.debug.log(r.getUint32(t,!0),r.getUint32(e,!0)),0},args_get(t,e){const r=new DataView(f.inst.exports.memory.buffer),n=new Uint8Array(f.inst.exports.memory.buffer),i=e;for(let s=0;s<f.args.length;s++){r.setUint32(t,e,!0),t+=4;const i=(new TextEncoder).encode(f.args[s]);n.set(i,e),r.setUint8(e+i.length,0),e+=i.length+1}return s.debug.enabled&&s.debug.log(new TextDecoder("utf-8").decode(n.slice(i,e))),0},environ_sizes_get(t,e){const r=new DataView(f.inst.exports.memory.buffer);r.setUint32(t,f.env.length,!0);let n=0;for(const t of f.env)n+=t.length+1;return r.setUint32(e,n,!0),s.debug.log(r.getUint32(t,!0),r.getUint32(e,!0)),0},environ_get(t,e){const r=new DataView(f.inst.exports.memory.buffer),n=new Uint8Array(f.inst.exports.memory.buffer),i=e;for(let s=0;s<f.env.length;s++){r.setUint32(t,e,!0),t+=4;const i=(new TextEncoder).encode(f.env[s]);n.set(i,e),r.setUint8(e+i.length,0),e+=i.length+1}return s.debug.enabled&&s.debug.log(new TextDecoder("utf-8").decode(n.slice(i,e))),0},clock_res_get(t,e){let r;switch(t){case n.CLOCKID_MONOTONIC:r=5000n;break;case n.CLOCKID_REALTIME:r=1000000n;break;default:return n.ERRNO_NOSYS}return new DataView(f.inst.exports.memory.buffer).setBigUint64(e,r,!0),n.ERRNO_SUCCESS},clock_time_get(t,e,r){const s=new DataView(f.inst.exports.memory.buffer);if(t===n.CLOCKID_REALTIME)s.setBigUint64(r,1000000n*BigInt((new Date).getTime()),!0);else if(t==n.CLOCKID_MONOTONIC){let t;try{t=BigInt(Math.round(1e6*performance.now()))}catch(e){t=0n}s.setBigUint64(r,t,!0)}else s.setBigUint64(r,0n,!0);return 0},fd_advise:(t,e,r,s)=>null!=f.fds[t]?f.fds[t].fd_advise(e,r,s):n.ERRNO_BADF,fd_allocate:(t,e,r)=>null!=f.fds[t]?f.fds[t].fd_allocate(e,r):n.ERRNO_BADF,fd_close(t){if(null!=f.fds[t]){const e=f.fds[t].fd_close();return f.fds[t]=void 0,e}return n.ERRNO_BADF},fd_datasync:t=>null!=f.fds[t]?f.fds[t].fd_datasync():n.ERRNO_BADF,fd_fdstat_get(t,e){if(null!=f.fds[t]){const{ret:r,fdstat:n}=f.fds[t].fd_fdstat_get();return null!=n&&n.write_bytes(new DataView(f.inst.exports.memory.buffer),e),r}return n.ERRNO_BADF},fd_fdstat_set_flags:(t,e)=>null!=f.fds[t]?f.fds[t].fd_fdstat_set_flags(e):n.ERRNO_BADF,fd_fdstat_set_rights:(t,e,r)=>null!=f.fds[t]?f.fds[t].fd_fdstat_set_rights(e,r):n.ERRNO_BADF,fd_filestat_get(t,e){if(null!=f.fds[t]){const{ret:r,filestat:n}=f.fds[t].fd_filestat_get();return null!=n&&n.write_bytes(new DataView(f.inst.exports.memory.buffer),e),r}return n.ERRNO_BADF},fd_filestat_set_size:(t,e)=>null!=f.fds[t]?f.fds[t].fd_filestat_set_size(e):n.ERRNO_BADF,fd_filestat_set_times:(t,e,r,s)=>null!=f.fds[t]?f.fds[t].fd_filestat_set_times(e,r,s):n.ERRNO_BADF,fd_pread(t,e,r,s,i){const _=new DataView(f.inst.exports.memory.buffer),o=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const R=n.Iovec.read_bytes_array(_,e,r),{ret:a,nread:l}=f.fds[t].fd_pread(o,R,s);return _.setUint32(i,l,!0),a}return n.ERRNO_BADF},fd_prestat_get(t,e){const r=new DataView(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const{ret:n,prestat:s}=f.fds[t].fd_prestat_get();return null!=s&&s.write_bytes(r,e),n}return n.ERRNO_BADF},fd_prestat_dir_name(t,e,r){if(null!=f.fds[t]){const{ret:r,prestat_dir_name:n}=f.fds[t].fd_prestat_dir_name();return null!=n&&new Uint8Array(f.inst.exports.memory.buffer).set(n,e),r}return n.ERRNO_BADF},fd_pwrite(t,e,r,s,i){const _=new DataView(f.inst.exports.memory.buffer),o=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const R=n.Ciovec.read_bytes_array(_,e,r),{ret:a,nwritten:l}=f.fds[t].fd_pwrite(o,R,s);return _.setUint32(i,l,!0),a}return n.ERRNO_BADF},fd_read(t,e,r,s){const i=new DataView(f.inst.exports.memory.buffer),_=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=n.Iovec.read_bytes_array(i,e,r),{ret:R,nread:a}=f.fds[t].fd_read(_,o);return i.setUint32(s,a,!0),R}return n.ERRNO_BADF},fd_readdir(t,e,r,s,i){const _=new DataView(f.inst.exports.memory.buffer),o=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){let n=0;for(;;){const{ret:R,dirent:a}=f.fds[t].fd_readdir_single(s);if(0!=R)return _.setUint32(i,n,!0),R;if(null==a)break;if(r-n<a.head_length()){n=r;break}const l=new ArrayBuffer(a.head_length());if(a.write_head_bytes(new DataView(l),0),o.set(new Uint8Array(l).slice(0,Math.min(l.byteLength,r-n)),e),e+=a.head_length(),n+=a.head_length(),r-n<a.name_length()){n=r;break}a.write_name_bytes(o,e,r-n),e+=a.name_length(),n+=a.name_length(),s=a.d_next}return _.setUint32(i,n,!0),0}return n.ERRNO_BADF},fd_renumber(t,e){if(null!=f.fds[t]&&null!=f.fds[e]){const r=f.fds[e].fd_close();return 0!=r?r:(f.fds[e]=f.fds[t],f.fds[t]=void 0,0)}return n.ERRNO_BADF},fd_seek(t,e,r,s){const i=new DataView(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const{ret:n,offset:_}=f.fds[t].fd_seek(e,r);return i.setBigInt64(s,_,!0),n}return n.ERRNO_BADF},fd_sync:t=>null!=f.fds[t]?f.fds[t].fd_sync():n.ERRNO_BADF,fd_tell(t,e){const r=new DataView(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const{ret:n,offset:s}=f.fds[t].fd_tell();return r.setBigUint64(e,s,!0),n}return n.ERRNO_BADF},fd_write(t,e,r,s){const i=new DataView(f.inst.exports.memory.buffer),_=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=n.Ciovec.read_bytes_array(i,e,r),{ret:R,nwritten:a}=f.fds[t].fd_write(_,o);return i.setUint32(s,a,!0),R}return n.ERRNO_BADF},path_create_directory(t,e,r){const n=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const s=new TextDecoder("utf-8").decode(n.slice(e,e+r));return f.fds[t].path_create_directory(s)}},path_filestat_get(t,e,r,s,i){const _=new DataView(f.inst.exports.memory.buffer),o=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const n=new TextDecoder("utf-8").decode(o.slice(r,r+s)),{ret:R,filestat:a}=f.fds[t].path_filestat_get(e,n);return null!=a&&a.write_bytes(_,i),R}return n.ERRNO_BADF},path_filestat_set_times(t,e,r,s,i,_,o){const R=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const n=new TextDecoder("utf-8").decode(R.slice(r,r+s));return f.fds[t].path_filestat_set_times(e,n,i,_,o)}return n.ERRNO_BADF},path_link(t,e,r,s,i,_,o){const R=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]&&null!=f.fds[i]){const n=new TextDecoder("utf-8").decode(R.slice(r,r+s)),a=new TextDecoder("utf-8").decode(R.slice(_,_+o));return f.fds[i].path_link(t,e,n,a)}return n.ERRNO_BADF},path_open(t,e,r,i,_,o,R,a,l){const d=new DataView(f.inst.exports.memory.buffer),E=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const n=new TextDecoder("utf-8").decode(E.slice(r,r+i));s.debug.log(n);const{ret:u,fd_obj:N}=f.fds[t].path_open(e,n,_,o,R,a);if(0!=u)return u;f.fds.push(N);const c=f.fds.length-1;return d.setUint32(l,c,!0),0}return n.ERRNO_BADF},path_readlink(t,e,r,i,_,o){const R=new DataView(f.inst.exports.memory.buffer),a=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const l=new TextDecoder("utf-8").decode(a.slice(e,e+r));s.debug.log(l);const{ret:d,data:E}=f.fds[t].path_readlink(l);if(null!=E){const t=(new TextEncoder).encode(E);if(t.length>_)return R.setUint32(o,0,!0),n.ERRNO_BADF;a.set(t,i),R.setUint32(o,t.length,!0)}return d}return n.ERRNO_BADF},path_remove_directory(t,e,r){const s=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const n=new TextDecoder("utf-8").decode(s.slice(e,e+r));return f.fds[t].path_remove_directory(n)}return n.ERRNO_BADF},path_rename(t,e,r,n,s,i){throw"FIXME what is the best abstraction for this?"},path_symlink(t,e,r,s,i){const _=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[r]){const n=new TextDecoder("utf-8").decode(_.slice(t,t+e)),o=new TextDecoder("utf-8").decode(_.slice(s,s+i));return f.fds[r].path_symlink(n,o)}return n.ERRNO_BADF},path_unlink_file(t,e,r){const s=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const n=new TextDecoder("utf-8").decode(s.slice(e,e+r));return f.fds[t].path_unlink_file(n)}return n.ERRNO_BADF},poll_oneoff(t,e,r){throw"async io not supported"},proc_exit(t){throw new i(t)},proc_raise(t){throw"raised signal "+t},sched_yield(){},random_get(t,e){const r=new Uint8Array(f.inst.exports.memory.buffer);for(let n=0;n<e;n++)r[t+n]=256*Math.random()|0},sock_recv(t,e,r){throw"sockets not supported"},sock_send(t,e,r){throw"sockets not supported"},sock_shutdown(t,e){throw"sockets not supported"},sock_accept(t,e){throw"sockets not supported"}}}}},228:(t,e,r)=>{r.r(e),r.d(e,{ADVICE_DONTNEED:()=>ye,ADVICE_NOREUSE:()=>Le,ADVICE_NORMAL:()=>Ae,ADVICE_RANDOM:()=>ge,ADVICE_SEQUENTIAL:()=>pe,ADVICE_WILLNEED:()=>De,CLOCKID_MONOTONIC:()=>f,CLOCKID_PROCESS_CPUTIME_ID:()=>o,CLOCKID_REALTIME:()=>_,CLOCKID_THREAD_CPUTIME_ID:()=>R,Ciovec:()=>Re,Dirent:()=>Ie,ERRNO_2BIG:()=>l,ERRNO_ACCES:()=>d,ERRNO_ADDRINUSE:()=>E,ERRNO_ADDRNOTAVAIL:()=>u,ERRNO_AFNOSUPPORT:()=>N,ERRNO_AGAIN:()=>c,ERRNO_ALREADY:()=>O,ERRNO_BADF:()=>h,ERRNO_BADMSG:()=>T,ERRNO_BUSY:()=>S,ERRNO_CANCELED:()=>I,ERRNO_CHILD:()=>A,ERRNO_CONNABORTED:()=>p,ERRNO_CONNREFUSED:()=>g,ERRNO_CONNRESET:()=>D,ERRNO_DEADLK:()=>y,ERRNO_DESTADDRREQ:()=>L,ERRNO_DOM:()=>b,ERRNO_DQUOT:()=>F,ERRNO_EXIST:()=>w,ERRNO_FAULT:()=>U,ERRNO_FBIG:()=>C,ERRNO_HOSTUNREACH:()=>m,ERRNO_IDRM:()=>P,ERRNO_ILSEQ:()=>G,ERRNO_INPROGRESS:()=>B,ERRNO_INTR:()=>x,ERRNO_INVAL:()=>H,ERRNO_IO:()=>Y,ERRNO_ISCONN:()=>k,ERRNO_ISDIR:()=>M,ERRNO_LOOP:()=>V,ERRNO_MFILE:()=>v,ERRNO_MLINK:()=>W,ERRNO_MSGSIZE:()=>K,ERRNO_MULTIHOP:()=>z,ERRNO_NAMETOOLONG:()=>j,ERRNO_NETDOWN:()=>X,ERRNO_NETRESET:()=>Q,ERRNO_NETUNREACH:()=>Z,ERRNO_NFILE:()=>q,ERRNO_NOBUFS:()=>J,ERRNO_NODEV:()=>$,ERRNO_NOENT:()=>tt,ERRNO_NOEXEC:()=>et,ERRNO_NOLCK:()=>rt,ERRNO_NOLINK:()=>nt,ERRNO_NOMEM:()=>st,ERRNO_NOMSG:()=>it,ERRNO_NOPROTOOPT:()=>_t,ERRNO_NOSPC:()=>ft,ERRNO_NOSYS:()=>ot,ERRNO_NOTCAPABLE:()=>Ct,ERRNO_NOTCONN:()=>Rt,ERRNO_NOTDIR:()=>at,ERRNO_NOTEMPTY:()=>lt,ERRNO_NOTRECOVERABLE:()=>dt,ERRNO_NOTSOCK:()=>Et,ERRNO_NOTSUP:()=>ut,ERRNO_NOTTY:()=>Nt,ERRNO_NXIO:()=>ct,ERRNO_OVERFLOW:()=>Ot,ERRNO_OWNERDEAD:()=>ht,ERRNO_PERM:()=>Tt,ERRNO_PIPE:()=>St,ERRNO_PROTO:()=>It,ERRNO_PROTONOSUPPORT:()=>At,ERRNO_PROTOTYPE:()=>pt,ERRNO_RANGE:()=>gt,ERRNO_ROFS:()=>Dt,ERRNO_SPIPE:()=>yt,ERRNO_SRCH:()=>Lt,ERRNO_STALE:()=>bt,ERRNO_SUCCESS:()=>a,ERRNO_TIMEDOUT:()=>Ft,ERRNO_TXTBSY:()=>wt,ERRNO_XDEV:()=>Ut,EVENTRWFLAGS_FD_READWRITE_HANGUP:()=>ze,EVENTTYPE_CLOCK:()=>ve,EVENTTYPE_FD_READ:()=>We,EVENTTYPE_FD_WRITE:()=>Ke,FDFLAGS_APPEND:()=>be,FDFLAGS_DSYNC:()=>Fe,FDFLAGS_NONBLOCK:()=>we,FDFLAGS_RSYNC:()=>Ue,FDFLAGS_SYNC:()=>Ce,FD_STDERR:()=>i,FD_STDIN:()=>n,FD_STDOUT:()=>s,FILETYPE_BLOCK_DEVICE:()=>ue,FILETYPE_CHARACTER_DEVICE:()=>Ne,FILETYPE_DIRECTORY:()=>ce,FILETYPE_REGULAR_FILE:()=>Oe,FILETYPE_SOCKET_DGRAM:()=>he,FILETYPE_SOCKET_STREAM:()=>Te,FILETYPE_SYMBOLIC_LINK:()=>Se,FILETYPE_UNKNOWN:()=>Ee,FSTFLAGS_ATIM:()=>Pe,FSTFLAGS_ATIM_NOW:()=>Ge,FSTFLAGS_MTIM:()=>Be,FSTFLAGS_MTIM_NOW:()=>xe,Fdstat:()=>me,Filestat:()=>Ve,Iovec:()=>oe,OFLAGS_CREAT:()=>He,OFLAGS_DIRECTORY:()=>Ye,OFLAGS_EXCL:()=>ke,OFLAGS_TRUNC:()=>Me,PREOPENTYPE_DIR:()=>wr,Prestat:()=>Cr,PrestatDir:()=>Ur,RIFLAGS_RECV_PEEK:()=>Dr,RIFLAGS_RECV_WAITALL:()=>yr,RIGHTS_FD_ADVISE:()=>kt,RIGHTS_FD_ALLOCATE:()=>Mt,RIGHTS_FD_DATASYNC:()=>mt,RIGHTS_FD_FDSTAT_SET_FLAGS:()=>Bt,RIGHTS_FD_FILESTAT_GET:()=>te,RIGHTS_FD_FILESTAT_SET_SIZE:()=>ee,RIGHTS_FD_FILESTAT_SET_TIMES:()=>re,RIGHTS_FD_READ:()=>Pt,RIGHTS_FD_READDIR:()=>jt,RIGHTS_FD_SEEK:()=>Gt,RIGHTS_FD_SYNC:()=>xt,RIGHTS_FD_TELL:()=>Ht,RIGHTS_FD_WRITE:()=>Yt,RIGHTS_PATH_CREATE_DIRECTORY:()=>Vt,RIGHTS_PATH_CREATE_FILE:()=>vt,RIGHTS_PATH_FILESTAT_GET:()=>qt,RIGHTS_PATH_FILESTAT_SET_SIZE:()=>Jt,RIGHTS_PATH_FILESTAT_SET_TIMES:()=>$t,RIGHTS_PATH_LINK_SOURCE:()=>Wt,RIGHTS_PATH_LINK_TARGET:()=>Kt,RIGHTS_PATH_OPEN:()=>zt,RIGHTS_PATH_READLINK:()=>Xt,RIGHTS_PATH_REMOVE_DIRECTORY:()=>se,RIGHTS_PATH_RENAME_SOURCE:()=>Qt,RIGHTS_PATH_RENAME_TARGET:()=>Zt,RIGHTS_PATH_SYMLINK:()=>ne,RIGHTS_PATH_UNLINK_FILE:()=>ie,RIGHTS_POLL_FD_READWRITE:()=>_e,RIGHTS_SOCK_SHUTDOWN:()=>fe,ROFLAGS_RECV_DATA_TRUNCATED:()=>Lr,SDFLAGS_RD:()=>br,SDFLAGS_WR:()=>Fr,SIGNAL_ABRT:()=>tr,SIGNAL_ALRM:()=>or,SIGNAL_BUS:()=>er,SIGNAL_CHLD:()=>ar,SIGNAL_CONT:()=>lr,SIGNAL_FPE:()=>rr,SIGNAL_HUP:()=>Qe,SIGNAL_ILL:()=>Je,SIGNAL_INT:()=>Ze,SIGNAL_KILL:()=>nr,SIGNAL_NONE:()=>Xe,SIGNAL_PIPE:()=>fr,SIGNAL_POLL:()=>Ar,SIGNAL_PROF:()=>Sr,SIGNAL_PWR:()=>pr,SIGNAL_QUIT:()=>qe,SIGNAL_SEGV:()=>ir,SIGNAL_STOP:()=>dr,SIGNAL_SYS:()=>gr,SIGNAL_TERM:()=>Rr,SIGNAL_TRAP:()=>$e,SIGNAL_TSTP:()=>Er,SIGNAL_TTIN:()=>ur,SIGNAL_TTOU:()=>Nr,SIGNAL_URG:()=>cr,SIGNAL_USR1:()=>sr,SIGNAL_USR2:()=>_r,SIGNAL_VTALRM:()=>Tr,SIGNAL_WINCH:()=>Ir,SIGNAL_XCPU:()=>Or,SIGNAL_XFSZ:()=>hr,SUBCLOCKFLAGS_SUBSCRIPTION_CLOCK_ABSTIME:()=>je,WHENCE_CUR:()=>le,WHENCE_END:()=>de,WHENCE_SET:()=>ae});const n=0,s=1,i=2,_=0,f=1,o=2,R=3,a=0,l=1,d=2,E=3,u=4,N=5,c=6,O=7,h=8,T=9,S=10,I=11,A=12,p=13,g=14,D=15,y=16,L=17,b=18,F=19,w=20,U=21,C=22,m=23,P=24,G=25,B=26,x=27,H=28,Y=29,k=30,M=31,V=32,v=33,W=34,K=35,z=36,j=37,X=38,Q=39,Z=40,q=41,J=42,$=43,tt=44,et=45,rt=46,nt=47,st=48,it=49,_t=50,ft=51,ot=52,Rt=53,at=54,lt=55,dt=56,Et=57,ut=58,Nt=59,ct=60,Ot=61,ht=62,Tt=63,St=64,It=65,At=66,pt=67,gt=68,Dt=69,yt=70,Lt=71,bt=72,Ft=73,wt=74,Ut=75,Ct=76,mt=1,Pt=2,Gt=4,Bt=8,xt=16,Ht=32,Yt=64,kt=128,Mt=256,Vt=512,vt=1024,Wt=2048,Kt=4096,zt=8192,jt=16384,Xt=32768,Qt=65536,Zt=1<<17,qt=1<<18,Jt=1<<19,$t=1<<20,te=1<<21,ee=1<<22,re=1<<23,ne=1<<24,se=1<<25,ie=1<<26,_e=1<<27,fe=1<<28;class oe{static read_bytes(t,e){const r=new oe;return r.buf=t.getUint32(e,!0),r.buf_len=t.getUint32(e+4,!0),r}static read_bytes_array(t,e,r){const n=[];for(let s=0;s<r;s++)n.push(oe.read_bytes(t,e+8*s));return n}}class Re{static read_bytes(t,e){const r=new Re;return r.buf=t.getUint32(e,!0),r.buf_len=t.getUint32(e+4,!0),r}static read_bytes_array(t,e,r){const n=[];for(let s=0;s<r;s++)n.push(Re.read_bytes(t,e+8*s));return n}}const ae=0,le=1,de=2,Ee=0,ue=1,Ne=2,ce=3,Oe=4,he=5,Te=6,Se=7;class Ie{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(t,e){t.setBigUint64(e,this.d_next,!0),t.setBigUint64(e+8,this.d_ino,!0),t.setUint32(e+16,this.dir_name.length,!0),t.setUint8(e+20,this.d_type)}write_name_bytes(t,e,r){t.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,r)),e)}constructor(t,e,r){this.d_ino=1n;const n=(new TextEncoder).encode(e);this.d_next=t,this.d_namlen=n.byteLength,this.d_type=r,this.dir_name=n}}const Ae=0,pe=1,ge=2,De=3,ye=4,Le=5,be=1,Fe=2,we=4,Ue=8,Ce=16;class me{write_bytes(t,e){t.setUint8(e,this.fs_filetype),t.setUint16(e+2,this.fs_flags,!0),t.setBigUint64(e+8,this.fs_rights_base,!0),t.setBigUint64(e+16,this.fs_rights_inherited,!0)}constructor(t,e){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=t,this.fs_flags=e}}const Pe=1,Ge=2,Be=4,xe=8,He=1,Ye=2,ke=4,Me=8;class Ve{write_bytes(t,e){t.setBigUint64(e,this.dev,!0),t.setBigUint64(e+8,this.ino,!0),t.setUint8(e+16,this.filetype),t.setBigUint64(e+24,this.nlink,!0),t.setBigUint64(e+32,this.size,!0),t.setBigUint64(e+38,this.atim,!0),t.setBigUint64(e+46,this.mtim,!0),t.setBigUint64(e+52,this.ctim,!0)}constructor(t,e){this.dev=0n,this.ino=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.filetype=t,this.size=e}}const ve=0,We=1,Ke=2,ze=1,je=1,Xe=0,Qe=1,Ze=2,qe=3,Je=4,$e=5,tr=6,er=7,rr=8,nr=9,sr=10,ir=11,_r=12,fr=13,or=14,Rr=15,ar=16,lr=17,dr=18,Er=19,ur=20,Nr=21,cr=22,Or=23,hr=24,Tr=25,Sr=26,Ir=27,Ar=28,pr=29,gr=30,Dr=1,yr=2,Lr=1,br=1,Fr=2,wr=0;class Ur{write_bytes(t,e){t.setUint32(e,this.pr_name_len,!0)}constructor(t){this.pr_name_len=t}}class Cr{static dir(t){const e=new Cr;return e.tag=wr,e.inner=new Ur(t),e}write_bytes(t,e){t.setUint32(e,this.tag,!0),this.inner.write_bytes(t,e+4)}}}},e={};function r(n){var s=e[n];if(void 0!==s)return s.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{r.r(n),r.d(n,{ConsoleStdout:()=>s.ConsoleStdout,Directory:()=>s.Directory,Fd:()=>e.Fd,File:()=>s.File,OpenDirectory:()=>s.OpenDirectory,OpenFile:()=>s.OpenFile,OpenSyncOPFSFile:()=>s.OpenSyncOPFSFile,PreopenDirectory:()=>s.PreopenDirectory,SyncOPFSFile:()=>s.SyncOPFSFile,WASI:()=>t.default,strace:()=>i.strace,wasi:()=>_});var t=r(93),e=r(851),s=r(862),i=r(171),_=r(228)})(),n})()));